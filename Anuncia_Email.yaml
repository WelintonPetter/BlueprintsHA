mode: queued
fields:
  onde_anunciar:
    selector:
      entity:
        filter:
          - integration: alexa_media
            domain: media_player
        multiple: true
    name: Onde Anunciar
    required: true
    default: []
    description: Escolha as Alexas
  volume:
    selector:
      number:
        min: 0.1
        max: 1
        step: 0.1
    default: 0.9
    name: Volume
    description: Escolha o volume do anúncio (padrão 90%)
sequence:
  - metadata: {}
    data:
      volume_level: '{{ volume }}'
    target:
      entity_id: '{{ onde_anunciar }}'
    action: media_player.volume_set
  - delay:
      hours: 0
      minutes: 0
      seconds: 1
      milliseconds: 0
  - data:
      message: >
        Você tem um novo e-mail com o assunto: {{ states['sensor.ultimo_titulo_email'].state }}.
      data:
        type: announce
      target: '{{ onde_anunciar }}'
    action: notify.alexa_media
  - delay:
      hours: 0
      minutes: 0
      seconds: 15
      milliseconds: 0
  - data:
      message: >
        Remetente: {{ states['sensor.ultimo_titulo_email'].attributes['Remetente'] }}.
      data:
        type: announce
      target: '{{ onde_anunciar }}'
    action: notify.alexa_media
  - delay:
      hours: 0
      minutes: 0
      seconds: 25
      milliseconds: 0
  - metadata: {}
    data:
      volume_level: 0.3
    target:
      entity_id: '{{ onde_anunciar }}'
    action: media_player.volume_set
icon: mdi:email
alias: Anunciar Novo E-mail
